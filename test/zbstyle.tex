\usepackage{fancyhdr}
\usepackage{lipsum}
\usepackage{lastpage}
\usepackage{atbegshi}
\usepackage{zref-savepos}

\pagestyle{fancy}
% \fancyhead[EL]{\includegraphics[width=0.8]{./logo/zblogo.png}}
\fancyhf{}
\fancyhead[L]{\includegraphics[height=\headheight]{./logo/zb.jpg}淄博实验中学2025级高一物理第9期}
\fancyhead[R]{命制人：冯振华\quad 审核人：冯振华}
\fancyfoot[L]{\parbox[C]{0.5\textwidth}{\centering{}第\thefpage{}页 \,{}共\pageref{LastPage}页}\addtocounter{fpage}{2}}
\fancyfoot[R]{\parbox[C]{0.5\textwidth}{\centering{}第\thespage{}页 \,{}共\pageref{LastPage}页}\addtocounter{spage}{2}}

\newcounter{fpage}
\newcounter{spage}
\newcounter{fspage}
\newcounter{fspages}
\setcounter{fpage}{1}
\setcounter{spage}{2}

\makeatletter
% 定义在栏末尾添加标记的命令
\newcommand{\columnendmark}{%
  \zsavepos{column-end-\thepage-\if@firstcolumn 1\else 2\fi}%
  \if@firstcolumn
      \setcounter{fspages}{\thefpage}
  \else
      \setcounter{fspages}{\thespage}
  %     \llap{\raisebox{-\baselineskip}{\makebox[0pt][r]{\addtocounter{fpage}{2}}}}%
  % \else
  %     \llap{\raisebox{-\baselineskip}{\makebox[0pt][r]{\addtocounter{spage}{2}}}}%
  \fi
}

% 自动在每栏末尾添加标记
\AtEndDocument{%
    \columnendmark
    \immediate\write\pagefile{\string\setcounter{fspage}{\thefspages}}
}
\makeatother

\newwrite{\pagefile}
\immediate\openout\pagefile=zbpage.aux

\setcounter {fspage}{8}
